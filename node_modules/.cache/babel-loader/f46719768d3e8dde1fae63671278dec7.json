{"ast":null,"code":"import _classCallCheck from\"C:\\\\Users\\\\\\u017Diga\\\\Desktop\\\\Ineor\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\\\u017Diga\\\\Desktop\\\\Ineor\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"C:\\\\Users\\\\\\u017Diga\\\\Desktop\\\\Ineor\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"C:\\\\Users\\\\\\u017Diga\\\\Desktop\\\\Ineor\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React,{Component}from'react';import'../sass/bookappointment.scss';import{TimePicker}from'./TimePicker';import{Redirect}from'react-router-dom';export var baseUrl='http://localhost:3004';export var BookAppointment=/*#__PURE__*/function(_Component){_inherits(BookAppointment,_Component);var _super=_createSuper(BookAppointment);function BookAppointment(props){var _this;_classCallCheck(this,BookAppointment);_this=_super.call(this,props);_this.callbackGetDateValue=function(date){_this.setState({dateValue:date.toLocaleDateString()}/* () => console.log(this.state.dateValue) */);var fields=_this.state.fields;fields['date']=date;_this.setState({fields:fields});};_this.callbackGetTimeValue=function(time){_this.setState({timeValue:time.toLocaleTimeString()}/* () => console.log(this.state.timeValue) */);var fields=_this.state.fields;fields['time']=time;_this.setState({fields:fields});};_this.handleClick=function(field,e){var fields=_this.state.fields;fields['service']=e.target.value;_this.setState({fields:fields});_this.setState({price:e.target.value,dateDisabled:false}/*  () => console.log(this.state.selectedService) */);if(e.target.value===\"1\"){_this.setState({servicePrice:\"Price is 15$\"});}else if(e.target.value===\"2\"){_this.setState({servicePrice:\"Price is 20$\"});}else if(e.target.value===\"3\"){_this.setState({servicePrice:\"Price is 30$\"});}else{}};_this.onChange=function(field,e){_this.setState({getWorkingHours:_this.state.barbers.map(function(barber){return barber.workHours;}),serviceDisable:false});var fields=_this.state.fields;fields['barber']=e.target.value;_this.setState({fields:fields});};_this.state={fields:{},errors:{},barbers:[],services:[],startDate:new Date(),price:null,servicePrice:\"Service Price\",dateDisabled:true,timeDisabled:true,serviceDuration:0,serviceDisable:true,getWorkingHours:null,test:[],formValidated:null,dateValue:null,timeValue:null,postId:null};return _this;}_createClass(BookAppointment,[{key:\"handleValidation\",value:function handleValidation(){var fields=this.state.fields;var errors={};var formIsValid=true;/* console.log(this.state.dateValue) */ //Name\nif(!fields[\"name\"]||!fields[\"surname\"]){formIsValid=false;errors[\"name\"]=\"Please enter your full name\";}if(typeof fields[\"name\"]!==\"undefined\"){if(!fields[\"name\"].match(/^[a-zA-Z]+$/)){formIsValid=false;errors[\"name\"]=\"Only letters\";}}//Email\nif(!fields[\"email\"]){formIsValid=false;errors[\"email\"]=\"Please enter your email\";}if(typeof fields[\"email\"]!==\"undefined\"){var lastAtPos=fields[\"email\"].lastIndexOf('@');var lastDotPos=fields[\"email\"].lastIndexOf('.');if(!(lastAtPos<lastDotPos&&lastAtPos>0&&fields[\"email\"].indexOf('@@')===-1&&lastDotPos>2&&fields[\"email\"].length-lastDotPos>2)){formIsValid=false;errors[\"email\"]=\"Please enter a valid email\";}}//Phone\nif(!fields[\"phone\"]){formIsValid=false;errors[\"phone\"]=\"Please enter phone number\";}//Barber\nif(!fields[\"barber\"]){formIsValid=false;errors[\"barber\"]=\"Please select a barber\";}//Service\nif(!fields[\"service\"]){formIsValid=false;errors[\"service\"]=\"Please select a service\";}// Date\nif(!fields[\"date\"]){formIsValid=false;errors[\"date\"]=\"Please select a date\";}// Time\nif(!fields[\"time\"]){formIsValid=false;errors[\"time\"]=\"Please select the time\";}/* console.log(this.state.fields) */this.setState({errors:errors});return formIsValid;}},{key:\"handleChange\",value:function handleChange(field,e){var fields=this.state.fields;fields[field]=e.target.value;this.setState({fields:fields});}},{key:\"handleSubmit\",value:function handleSubmit(event){var _this2=this;event.preventDefault();if(this.handleValidation()){this.setState({formValidated:true});var date=new Date(Date.parse(this.state.dateValue+\" \"+this.state.timeValue));var unixTimestamp=Math.floor(date.getTime()/1000);var requestOptions={method:'POST',headers:{'Content-Type':'application/json','Authorization':'Bearer my-token','My-Custom-Header':'foobar'},body:JSON.stringify({startDate:unixTimestamp,barberId:parseInt(this.state.fields['barber']),serviceId:parseInt(this.state.fields['service'])})};fetch('http://localhost:3004/appointments',requestOptions).then(function(response){return response.json();}).then(function(data){return _this2.setState({postId:data.id});});}else{this.setState({formValidated:false});}}},{key:\"componentDidMount\",value:function componentDidMount(){var _this3=this;// GET BARBERS\nfetch(baseUrl+'/barbers').then(function(getBarbers){return getBarbers.json();}).then(function(getBarbers){_this3.setState({barbers:getBarbers});}).catch(function(err){alert(\"Failed to load our Barbers\"+err);});// GET SERVICES\nfetch(baseUrl+'/services').then(function(getServices){return getServices.json();}).then(function(getServices){_this3.setState({services:getServices});}).catch(function(err){alert(\"Failed to load our Services\"+err);});}},{key:\"render\",value:function render(){var _this$state=this.state,barbers=_this$state.barbers,services=_this$state.services,servicePrice=_this$state.servicePrice,fields=_this$state.fields,errors=_this$state.errors,getWorkingHours=_this$state.getWorkingHours,dateDisabled=_this$state.dateDisabled,timeDisabled=_this$state.timeDisabled;if(this.state.formValidated===true){return/*#__PURE__*/React.createElement(Redirect,{to:\"barberbooked\"});}else{}return/*#__PURE__*/React.createElement(\"div\",{className:\"booking-app-wrapper\"},/*#__PURE__*/React.createElement(\"div\",{className:\"booking-app-title\"},/*#__PURE__*/React.createElement(\"h2\",null,\"Book your appointment\")),/*#__PURE__*/React.createElement(\"form\",{onSubmit:this.handleSubmit.bind(this)},/*#__PURE__*/React.createElement(\"div\",{className:\"input-wrapper\"},/*#__PURE__*/React.createElement(\"input\",{type:\"text\",placeholder:\"First Name\",onChange:this.handleChange.bind(this,\"name\"),value:fields[\"name\"]||''}),/*#__PURE__*/React.createElement(\"span\",{className:\"error\"},errors[\"name\"])),/*#__PURE__*/React.createElement(\"div\",{className:\"input-wrapper\"},/*#__PURE__*/React.createElement(\"input\",{type:\"text\",placeholder:\"Last Name\",onChange:this.handleChange.bind(this,\"surname\"),value:fields[\"surname\"]||''})),/*#__PURE__*/React.createElement(\"div\",{className:\"input-wrapper\"},/*#__PURE__*/React.createElement(\"input\",{placeholder:\"Email\",onChange:this.handleChange.bind(this,\"email\"),value:fields[\"email\"]||''}),/*#__PURE__*/React.createElement(\"span\",{className:\"error\"},errors[\"email\"])),/*#__PURE__*/React.createElement(\"div\",{className:\"input-wrapper\"},/*#__PURE__*/React.createElement(\"input\",{pattern:\"[0][0-9]{8}\",placeholder:\"Phone Number\",onChange:this.handleChange.bind(this,\"phone\"),value:fields[\"phone\"]||''}),/*#__PURE__*/React.createElement(\"span\",{className:\"error\"},errors[\"phone\"])),/*#__PURE__*/React.createElement(\"div\",{className:\"input-wrapper\"},/*#__PURE__*/React.createElement(\"select\",{value:fields[\"barber\"]||'',onChange:this.onChange.bind(this,\"barber\")},/*#__PURE__*/React.createElement(\"option\",{hidden:true},\"Select Barber\"),barbers.map(function(barber){return/*#__PURE__*/React.createElement(\"option\",{value:barber.id,key:barber.id},barber.firstName,\" \",barber.lastName);})),/*#__PURE__*/React.createElement(\"span\",{className:\"error\"},errors[\"barber\"])),/*#__PURE__*/React.createElement(\"div\",{className:\"input-wrapper\"},/*#__PURE__*/React.createElement(\"select\",{value:fields[\"service\"]||'',onChange:this.handleClick.bind(this,\"service\"),disabled:this.state.serviceDisable===true?\"disabled\":null},/*#__PURE__*/React.createElement(\"option\",{hidden:true},\"Select Service\"),services.map(function(service){return/*#__PURE__*/React.createElement(\"option\",{value:service.id,key:service.id},service.name);})),/*#__PURE__*/React.createElement(\"span\",{className:\"error\"},errors[\"service\"])),/*#__PURE__*/React.createElement(TimePicker,{serviceId:this.state.price,errors:this.state.errors,callbackGetTimeValue:this.callbackGetTimeValue,callbackGetDateValue:this.callbackGetDateValue,getWorkingHours:getWorkingHours,datedisabled:dateDisabled,timeDisabled:timeDisabled}),/*#__PURE__*/React.createElement(\"div\",{className:\"input-wrapper price\"},/*#__PURE__*/React.createElement(\"input\",{value:servicePrice,disabled:true})),/*#__PURE__*/React.createElement(\"input\",{type:\"submit\",value:\"Book appointment\"})));}}]);return BookAppointment;}(Component);export default BookAppointment;","map":{"version":3,"sources":["C:/Users/Å½iga/Desktop/Ineor/src/components/BookAppointment.js"],"names":["React","Component","TimePicker","Redirect","baseUrl","BookAppointment","props","callbackGetDateValue","date","setState","dateValue","toLocaleDateString","fields","state","callbackGetTimeValue","time","timeValue","toLocaleTimeString","handleClick","field","e","target","value","price","dateDisabled","servicePrice","onChange","getWorkingHours","barbers","map","barber","workHours","serviceDisable","errors","services","startDate","Date","timeDisabled","serviceDuration","test","formValidated","postId","formIsValid","match","lastAtPos","lastIndexOf","lastDotPos","indexOf","length","event","preventDefault","handleValidation","parse","unixTimestamp","Math","floor","getTime","requestOptions","method","headers","body","JSON","stringify","barberId","parseInt","serviceId","fetch","then","response","json","data","id","getBarbers","catch","err","alert","getServices","handleSubmit","bind","handleChange","firstName","lastName","service","name"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\r\nimport '../sass/bookappointment.scss';\r\nimport { TimePicker } from './TimePicker';\r\nimport { Redirect } from 'react-router-dom';\r\n\r\nexport const baseUrl = 'http://localhost:3004';\r\n\r\nexport class BookAppointment extends Component {\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            fields: {},\r\n            errors: {},\r\n            barbers: [],\r\n            services: [],\r\n            startDate: new Date(),\r\n            price: null,\r\n            servicePrice: \"Service Price\",\r\n            dateDisabled: true,\r\n            timeDisabled: true,\r\n            serviceDuration: 0,\r\n            serviceDisable: true,\r\n            getWorkingHours: null,\r\n            test: [],\r\n            formValidated: null,\r\n            dateValue: null,\r\n            timeValue: null,\r\n            postId: null,\r\n        };\r\n\r\n    }\r\n\r\n    callbackGetDateValue = (date) => {\r\n        this.setState({dateValue: date.toLocaleDateString()}, /* () => console.log(this.state.dateValue) */)\r\n        let fields = this.state.fields;\r\n        fields['date'] = date;        \r\n        this.setState({fields});\r\n    }\r\n\r\n    callbackGetTimeValue = (time) => {\r\n        this.setState({timeValue: time.toLocaleTimeString()}, /* () => console.log(this.state.timeValue) */)\r\n        let fields = this.state.fields;\r\n        fields['time'] = time;        \r\n        this.setState({fields});\r\n    }\r\n\r\n    handleValidation(){\r\n        let fields = this.state.fields;\r\n        let errors = {};\r\n        let formIsValid = true;\r\n        /* console.log(this.state.dateValue) */\r\n\r\n        //Name\r\n        if(!fields[\"name\"] || !fields[\"surname\"]){\r\n          formIsValid = false;\r\n          errors[\"name\"] = \"Please enter your full name\";\r\n        }\r\n    \r\n        if(typeof fields[\"name\"] !== \"undefined\"){\r\n          if(!fields[\"name\"].match(/^[a-zA-Z]+$/)){\r\n            formIsValid = false;\r\n            errors[\"name\"] = \"Only letters\";\r\n          }      \t\r\n        }\r\n    \r\n        //Email\r\n        if(!fields[\"email\"]){\r\n          formIsValid = false;\r\n          errors[\"email\"] = \"Please enter your email\";\r\n        }\r\n    \r\n        if(typeof fields[\"email\"] !== \"undefined\"){\r\n          let lastAtPos = fields[\"email\"].lastIndexOf('@');\r\n          let lastDotPos = fields[\"email\"].lastIndexOf('.');\r\n    \r\n          if (!(lastAtPos < lastDotPos && lastAtPos > 0 && fields[\"email\"].indexOf('@@') === -1 && lastDotPos > 2 && (fields[\"email\"].length - lastDotPos) > 2)) {\r\n            formIsValid = false;\r\n            errors[\"email\"] = \"Please enter a valid email\";\r\n          }\r\n        }\r\n\r\n        //Phone\r\n        if(!fields[\"phone\"]){\r\n            formIsValid = false;\r\n            errors[\"phone\"] = \"Please enter phone number\";\r\n          }\r\n\r\n        //Barber\r\n        if(!fields[\"barber\"]){\r\n            formIsValid = false;\r\n            errors[\"barber\"] = \"Please select a barber\";\r\n        }\r\n\r\n        //Service\r\n        if(!fields[\"service\"]){\r\n            formIsValid = false;\r\n            errors[\"service\"] = \"Please select a service\";\r\n        }\r\n\r\n        // Date\r\n        if(!fields[\"date\"]){\r\n            formIsValid = false;\r\n            errors[\"date\"] = \"Please select a date\";\r\n        }\r\n\r\n        // Time\r\n        if(!fields[\"time\"]){\r\n            formIsValid = false;\r\n            errors[\"time\"] = \"Please select the time\";\r\n        }\r\n        \r\n        /* console.log(this.state.fields) */\r\n        this.setState({errors: errors});\r\n        return formIsValid;\r\n\r\n    }\r\n    \r\n    handleChange(field, e){    \t\t\r\n        let fields = this.state.fields;\r\n        fields[field] = e.target.value;        \r\n        this.setState({fields});\r\n    }\r\n    \r\n    handleSubmit(event) {\r\n        event.preventDefault();\r\n        if(this.handleValidation()){\r\n            this.setState({\r\n                formValidated: true,\r\n            });\r\n\r\n            const date = new Date(Date.parse(this.state.dateValue + \" \" + this.state.timeValue));\r\n            const unixTimestamp = Math.floor(date.getTime() / 1000);\r\n\r\n            const requestOptions = {\r\n                method: 'POST',\r\n                headers: { \r\n                    'Content-Type': 'application/json',\r\n                    'Authorization': 'Bearer my-token',\r\n                    'My-Custom-Header': 'foobar'\r\n                },\r\n                body: JSON.stringify({\r\n                    startDate: unixTimestamp,\r\n                    barberId:   parseInt(this.state.fields['barber']),\r\n                    serviceId: parseInt(this.state.fields['service']),\r\n                })};\r\n\r\n            fetch('http://localhost:3004/appointments', requestOptions)\r\n                .then(response => response.json())\r\n                .then(data => this.setState({ postId: data.id }))\r\n        \r\n            } else {\r\n            this.setState({\r\n                formValidated: false,\r\n            })\r\n        }\r\n    }\r\n\r\n    handleClick = (field,e) => {\r\n        let fields = this.state.fields;\r\n        fields['service'] = e.target.value;        \r\n        this.setState({fields});\r\n\r\n        this.setState({\r\n            price: e.target.value,\r\n            dateDisabled: false,\r\n        }, /*  () => console.log(this.state.selectedService) */ )\r\n        \r\n        if (e.target.value === \"1\") {\r\n            this.setState({\r\n                servicePrice: \"Price is 15$\"\r\n            })\r\n        } else if (e.target.value === \"2\") {\r\n            this.setState({\r\n                servicePrice: \"Price is 20$\"\r\n            })\r\n        } else if (e.target.value === \"3\") {\r\n            this.setState({\r\n                servicePrice: \"Price is 30$\"\r\n            })\r\n        } else {\r\n            \r\n        }\r\n    }\r\n\r\n    onChange = ( field, e) => {\r\n        this.setState({\r\n            getWorkingHours: this.state.barbers.map(barber => barber.workHours),\r\n            serviceDisable: false,\r\n        });\r\n\r\n        let fields = this.state.fields;\r\n        fields['barber'] = e.target.value;        \r\n        this.setState({fields});\r\n    }\r\n\r\n    componentDidMount() {\r\n\r\n        // GET BARBERS\r\n\r\n        fetch(baseUrl + '/barbers')\r\n        .then(getBarbers => {\r\n            return getBarbers.json();\r\n        })\r\n        .then(getBarbers => {\r\n            this.setState({\r\n                barbers: getBarbers\r\n            })\r\n        })\r\n        .catch(err => {\r\n            alert(\"Failed to load our Barbers\" + err)\r\n        });\r\n\r\n        // GET SERVICES\r\n\r\n        fetch(baseUrl + '/services')\r\n        .then(getServices => {\r\n            return getServices.json();\r\n        })\r\n        .then(getServices => {\r\n            this.setState({\r\n                services: getServices\r\n            })\r\n        })\r\n        .catch(err => {\r\n            alert(\"Failed to load our Services\" + err)\r\n        });\r\n\r\n    }\r\n\r\n    \r\n\r\n    render() {\r\n        const { barbers, services, servicePrice, fields, errors, getWorkingHours, dateDisabled, timeDisabled } = this.state;\r\n        if (this.state.formValidated === true) {\r\n            return <Redirect to=\"barberbooked\"/>\r\n        } else {\r\n            \r\n        }\r\n        return (\r\n            <div className=\"booking-app-wrapper\">\r\n                <div className=\"booking-app-title\">\r\n                    <h2>Book your appointment</h2>\r\n                </div>\r\n\r\n                <form onSubmit={this.handleSubmit.bind(this)}>\r\n                    <div className=\"input-wrapper\">\r\n                        <input type=\"text\" placeholder=\"First Name\" onChange={this.handleChange.bind(this, \"name\")} value={fields[\"name\"] || ''}/>\r\n                        <span className=\"error\">{errors[\"name\"]}</span>\r\n                    </div>\r\n\r\n                    <div className=\"input-wrapper\">\r\n                        <input type=\"text\" placeholder=\"Last Name\" onChange={this.handleChange.bind(this, \"surname\")} value={fields[\"surname\"] || ''}/>\r\n                    </div>\r\n\r\n                    <div className=\"input-wrapper\">\r\n                        <input placeholder=\"Email\" onChange={this.handleChange.bind(this, \"email\")} value={fields[\"email\"] || ''} />\r\n                        <span className=\"error\">{errors[\"email\"]}</span>\r\n                    </div>\r\n\r\n                    <div className=\"input-wrapper\">\r\n                        <input pattern=\"[0][0-9]{8}\" placeholder=\"Phone Number\" onChange={this.handleChange.bind(this, \"phone\")} value={fields[\"phone\"] || ''}/>\r\n                        <span className=\"error\">{errors[\"phone\"]}</span>\r\n                    </div>\r\n\r\n                    <div className=\"input-wrapper\">\r\n                       <select value={fields[\"barber\"] || ''} onChange={this.onChange.bind(this, \"barber\")}>\r\n                           <option hidden>Select Barber</option>\r\n                           {barbers.map(barber => (\r\n                                <option value={barber.id} key={barber.id}>\r\n                                {barber.firstName} {barber.lastName}\r\n                                </option>\r\n                            ))}\r\n                       </select>\r\n                       <span className=\"error\">{errors[\"barber\"]}</span>\r\n                    </div>\r\n\r\n                    <div className=\"input-wrapper\">\r\n                       <select value={fields[\"service\"] || ''} onChange={this.handleClick.bind(this, \"service\")} disabled={(this.state.serviceDisable === true ) ? \"disabled\" : null}>\r\n                           <option hidden>Select Service</option>\r\n                           {services.map(service => (\r\n                                <option value={service.id}\r\n                                    key={service.id}>\r\n                                    {service.name}\r\n                                </option>\r\n                            ))}\r\n                       </select>\r\n                       <span className=\"error\">{errors[\"service\"]}</span>\r\n                    </div>\r\n\r\n                    <TimePicker \r\n                    serviceId={this.state.price}\r\n                    errors={this.state.errors}\r\n                    callbackGetTimeValue={this.callbackGetTimeValue}\r\n                    callbackGetDateValue={this.callbackGetDateValue} \r\n                    getWorkingHours={getWorkingHours} \r\n                    datedisabled={dateDisabled} \r\n                    timeDisabled={timeDisabled}\r\n                    />\r\n\r\n                    <div className=\"input-wrapper price\">\r\n                        <input value={servicePrice} disabled/>\r\n                    </div>\r\n                    \r\n                    <input type=\"submit\" value=\"Book appointment\" />\r\n                </form>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nexport default BookAppointment"]},"metadata":{},"sourceType":"module"}